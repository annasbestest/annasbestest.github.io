---
layout: post
title: "When I almost lost access to my Gmail account."
---



With scams and fraud on the rise, I thought Iâ€™d share a personal "near miss" experience and the steps I took to minimise the chance of it happening again. Hopefully this will never happen to you or anyone you know, but if it does, it may be helpful to know what to do and how to spot the warning signs.

## Wednesday, 9th October 2019
I wasn't feeling too well and decided to head home and dial into some meetings remotely. Just as the last meeting wrapped up at around 5:30 PM, I noticed my phone signal drop out and a Telstra email notification appear.

Initially, I didn't pay too much attention to the email and thought maybe it was related to why I had lost phone service.

Moments later, I received another notification on my phone that someone was attempting to sign into my Gmail account, asking whether it was me.

<figure>
  <img src="/assets/sim-swap/sign_in.png" alt="" loading="lazy">
  <figcaption>
    A example of the notification that appeared on my phone after losing phone signal.
  </figcaption>
</figure>

I quickly clicked NO, IT'S NOT ME as my heart started to race in a moment of panic and confusion. For the next minute, I had several of these prompts appear, to which I had to repeatedly click NO while fearing that I was about to lose access to my Gmail account.

The prompts eventually stopped, and as I began to compose myself, I recalled reading an article about the warning signs of losing access to your phone network and what it could potentially mean.

I then realised I was a victim of a SIM-swap attack, and the attacker was attempting to take over my Gmail account.

While the attacker was not successful, had I been at work or on the way home from work (likely the attacker's intention behind the 5:30 PM timing), I wouldn't have had WiFi and therefore wouldn't have been able to receive and decline the sign-in prompt. This could have resulted in a much worse outcome, with the attacker gaining access to my Gmail account.

But the story doesn't end there...

#### Some background on SIM-swapping
An unauthorised SIM-swap attack occurs when an attacker convinces a telco customer service representative (over the phone or in person) that they are _you_, so that they can move _your_ phone service from one physical SIM card (the one in your phone) to another physical SIM.

The attacker likely has their new, blank SIM card physically in their hands so that they can read out the SIM identifier to telco customer service over the phone.

After the SIM swap (porting my number to the attacker's new SIM) is complete, which can take place in a matter of minutes, the attacker can then use my phone number with complete freedom to send or receive SMS and phone calls. Then my SIM card in my phone will be rendered inactive.

<figure>
  <img src="/assets/sim-swap/email.png" alt="" loading="lazy">
  <figcaption>
    The SIM replacement email I received at 5:30PM 9th October 2019
  </figcaption>
</figure>

As soon as I realised that I was a victim of an unauthorised SIM-swap attack, I called my wife to ask if she could quickly come home so that I could use her phone to call Telstra and seek help on how to manage the situation. After navigating through first-line customer service, I was eventually able to speak to someone from their fraud department.

During this stressful experience, it was relieving to be assigned a dedicated Telstra fraud specialist with a direct contact number, who was able to talk me through what had happened and the next steps.

## Thursday, 10th October 2019
Based on the advice of the fraud specialist, I went to a Telstra store to verify my identity in person and port the number back to a new SIM card. 

Having some knowledge of how fraud is managed in banking, I knew that the banking process involves something like applying a fraud flag to the account so that the next time the customer profile is pulled up for an enquiry, bankers will treat the account with an elevated level of caution.

While the Telstra store staff were finalising the new SIM for me and writing notes in their system, I could see their screen and where exactly on the customer relationship console (it looked like Siebel) they were capturing the notes.

I asked if the console had something to indicate that the account had been compromised. They scrolled to the bottom of the page, as if it were the last place someone would look, opened up the notes from the night before, and we eventually found some brief notes regarding the fraud incident! This was over five years ago, so I would hope that by now they have enhanced the functionality of the console to make it more obvious that the account maintenance on compromised accounts requires an elevated level of caution.

With my new SIM set up, I left the store and went home to spend more time reviewing my Gmail account security.

#### Some background on the difference between SMS two-factor authentication (2FA) and SMS account recovery
You'll probably most often hear about SMS two-factor authentication, where, in addition to a password, the SMS acts as the second layer of protection. In my view, this is an effective way to employ SMS to enhance account security. For example, when you want to add a new payee to your banking account, you will likely receive an SMS as a second factor authentication (the first factor being logged into banking with your password).

The other way SMS is used, which is not so much a security enhancement, is to allow account _recovery_. Account recovery is required if you forget your Gmail password and need to reset it. In this case, the SMS is acting as the one and only authentication to access Gmail, and was the precise feature that the attacker was exploiting while attempting to take over my Gmail account.

At the time, it wasn't immediately obvious to me that this is how I had set up my Gmail security settings. From a security perspective, it makes no sense to have SMS enabled for both 2FA _and_ account recovery, since the 2FA can be bypassed by simply resetting the password (via account recovery).



